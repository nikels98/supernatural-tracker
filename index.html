<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Supernatural Episoden Tracker</title>
  <link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/thumb/3/30/Supernatural_Anti-Possession_Symbol.svg/64px-Supernatural_Anti-Possession_Symbol.svg.png" type="image/png">
  <style>
    body { font-family: Arial, sans-serif; background: #111; color: #eee; margin: 20px; }
    h1, h2 { color: #ffcc00; }
    .season { margin-bottom: 20px; padding: 10px; border: 1px solid #444; border-radius: 5px; }
    .season-header { display: flex; justify-content: space-between; align-items: center; }
    .completed { color: #00ff00; font-weight: bold; }
    ul { list-style: none; padding: 0; }
    li { margin: 5px 0; }
    .special { color: #00ccff; font-weight: bold; }
    button { background: #444; color: #eee; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; }
    button:hover { background: #666; }
    .stats { margin: 20px 0; font-size: 1.1em; }
  </style>
</head>
<body>
  <h1>üì∫ Supernatural Episoden Tracker</h1>
  <div class="stats">
    Verbleibende Zeit: <span id="remainingHours">0</span> Stunden<br>
    (Specials: <span id="remainingSpecials">0</span> Folgen)  
  </div>
  <div id="episodes"></div>

<script>
const seasons = {
  1: 22, 2: 22, 3: 16, 4: 22, 5: 22, 6: 22, 7: 23, 8: 23, 9: 23,
  10: 23, 11: 23, 12: 23, 13: 23, 14: 20, 15: 20
};

// Specials aus unserer Liste (Beispielmarkierung)
const specials = {
  "2x21": true, "2x22": true,
  "3x11": true,
  "4x01": true, "4x22": true,
  "5x08": true, "5x22": true,
  "6x15": true,
  "8x20": true,
  "9x01": true
};

const episodeLength = 42; // Minuten pro Folge
let watched = JSON.parse(localStorage.getItem("watchedEpisodes") || "[]");

function saveProgress() {
  localStorage.setItem("watchedEpisodes", JSON.stringify(watched));
  updateStats();
}

function toggleEpisode(epId) {
  if (watched.includes(epId)) {
    watched = watched.filter(e => e !== epId);
  } else {
    watched.push(epId);
  }
  saveProgress();
  renderSeasons();
}

function markSeason(season, all = true) {
  for (let i = 1; i <= seasons[season]; i++) {
    let epId = `${season}x${String(i).padStart(2,"0")}`;
    if (all && !watched.includes(epId)) watched.push(epId);
    if (!all) watched = watched.filter(e => e !== epId);
  }
  saveProgress();
  renderSeasons();
}

function updateStats() {
  const totalEpisodes = Object.values(seasons).reduce((a,b) => a+b, 0);
  const remaining = totalEpisodes - watched.length;
  const hours = Math.round((remaining * episodeLength) / 60);
  document.getElementById("remainingHours").textContent = hours;

  const remainingSpecials = Object.keys(specials).filter(e => !watched.includes(e)).length;
  document.getElementById("remainingSpecials").textContent = remainingSpecials;
}

function renderSeasons() {
  const container = document.getElementById("episodes");
  container.innerHTML = "";
  for (let s = 1; s <= 15; s++) {
    let div = document.createElement("div");
    div.className = "season";
    let header = document.createElement("div");
    header.className = "season-header";

    let title = document.createElement("h2");
    const seasonEpisodes = seasons[s];
    const completed = Array.from({length: seasonEpisodes}, (_,i) => `${s}x${String(i+1).padStart(2,"0")}`).every(e => watched.includes(e));
    title.textContent = `Staffel ${s}` + (completed ? " ‚úÖ" : "");

    let btnGroup = document.createElement("div");
    let btnAll = document.createElement("button");
    btnAll.textContent = "Staffel abhaken";
    btnAll.onclick = () => markSeason(s, true);
    let btnClear = document.createElement("button");
    btnClear.textContent = "Zur√ºcksetzen";
    btnClear.onclick = () => markSeason(s, false);
    btnGroup.appendChild(btnAll);
    btnGroup.appendChild(btnClear);

    header.appendChild(title);
    header.appendChild(btnGroup);

    let list = document.createElement("ul");
    for (let i = 1; i <= seasonEpisodes; i++) {
      let epId = `${s}x${String(i).padStart(2,"0")}`;
      let li = document.createElement("li");
      let cb = document.createElement("input");
      cb.type = "checkbox";
      cb.id = epId;
      cb.checked = watched.includes(epId);
      cb.onchange = () => toggleEpisode(epId);
      let label = document.createElement("label");
      label.setAttribute("for", epId);
      label.textContent = epId + (specials[epId] ? " ‚≠ê" : "");
      if (specials[epId]) label.className = "special";

      li.appendChild(cb);
      li.appendChild(label);
      list.appendChild(li);
    }

    div.appendChild(header);
    div.appendChild(list);
    container.appendChild(div);
  }
  updateStats();
}

renderSeasons();
</script>
</body>
</html>